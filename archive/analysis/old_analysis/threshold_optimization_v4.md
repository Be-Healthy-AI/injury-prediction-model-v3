# Threshold Optimization - V4 Models

Generated via scripts/tune_thresholds_v4.py

## Individual Models
### Random Forest
- Best F1 @ 0.25: F1 **0.433**, Precision 0.337, Recall 0.605
- Max Recall @ 0.20: Recall **0.777**, Precision 0.280

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.85 | 0.000 | 0.000 | 0.000 | 0.786 | 0 | 0 | 1247 | 220 |
| 0.80 | 0.000 | 0.000 | 0.000 | 0.786 | 0 | 0 | 1247 | 220 |
| 0.75 | 0.000 | 0.000 | 0.000 | 0.786 | 0 | 0 | 1247 | 220 |
| 0.70 | 0.000 | 0.000 | 0.000 | 0.786 | 0 | 0 | 1247 | 220 |
| 0.65 | 0.000 | 0.000 | 0.000 | 0.786 | 0 | 0 | 1247 | 220 |
| 0.60 | 0.000 | 0.000 | 0.000 | 0.786 | 0 | 0 | 1247 | 220 |
| 0.55 | 0.667 | 0.009 | 0.018 | 0.786 | 2 | 1 | 1246 | 218 |
| 0.50 | 0.636 | 0.032 | 0.061 | 0.786 | 7 | 4 | 1243 | 213 |
| 0.45 | 0.600 | 0.082 | 0.144 | 0.786 | 18 | 12 | 1235 | 202 |
| 0.40 | 0.600 | 0.164 | 0.257 | 0.786 | 36 | 24 | 1223 | 184 |
| 0.35 | 0.399 | 0.250 | 0.307 | 0.786 | 55 | 83 | 1164 | 165 |
| 0.30 | 0.362 | 0.418 | 0.388 | 0.786 | 92 | 162 | 1085 | 128 |
| 0.25 | 0.337 | 0.605 | 0.433 | 0.786 | 133 | 262 | 985 | 87 |
| 0.20 | 0.280 | 0.777 | 0.412 | 0.786 | 171 | 439 | 808 | 49 |

### Gradient Boosting
- Best F1 @ 0.20: F1 **0.067**, Precision 0.400, Recall 0.036
- Max Recall @ 0.20: Recall **0.036**, Precision 0.400

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.85 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 0 | 1247 | 220 |
| 0.80 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 0 | 1247 | 220 |
| 0.75 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 1 | 1246 | 220 |
| 0.70 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 1 | 1246 | 220 |
| 0.65 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 1 | 1246 | 220 |
| 0.60 | 0.500 | 0.005 | 0.009 | 0.737 | 1 | 1 | 1246 | 219 |
| 0.55 | 0.667 | 0.009 | 0.018 | 0.737 | 2 | 1 | 1246 | 218 |
| 0.50 | 0.500 | 0.009 | 0.018 | 0.737 | 2 | 2 | 1245 | 218 |
| 0.45 | 0.571 | 0.018 | 0.035 | 0.737 | 4 | 3 | 1244 | 216 |
| 0.40 | 0.500 | 0.018 | 0.035 | 0.737 | 4 | 4 | 1243 | 216 |
| 0.35 | 0.500 | 0.018 | 0.035 | 0.737 | 4 | 4 | 1243 | 216 |
| 0.30 | 0.400 | 0.018 | 0.035 | 0.737 | 4 | 6 | 1241 | 216 |
| 0.25 | 0.500 | 0.032 | 0.060 | 0.737 | 7 | 7 | 1240 | 213 |
| 0.20 | 0.400 | 0.036 | 0.067 | 0.737 | 8 | 12 | 1235 | 212 |

### Logistic Regression
- Best F1 @ 0.60: F1 **0.331**, Precision 0.212, Recall 0.759
- Max Recall @ 0.50: Recall **0.873**, Precision 0.190

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.50 | 0.190 | 0.873 | 0.313 | 0.660 | 192 | 816 | 431 | 28 |
| 0.55 | 0.201 | 0.827 | 0.324 | 0.660 | 182 | 723 | 524 | 38 |
| 0.60 | 0.212 | 0.759 | 0.331 | 0.660 | 167 | 621 | 626 | 53 |
| 0.65 | 0.204 | 0.618 | 0.307 | 0.660 | 136 | 531 | 716 | 84 |
| 0.70 | 0.222 | 0.509 | 0.309 | 0.660 | 112 | 393 | 854 | 108 |

## Ensembles
### RF 50% + GB 50%
- Best F1 @ 0.30: F1 **0.107**, Precision 0.565, Recall 0.059
- Max Recall @ 0.30: Recall **0.059**, Precision 0.565

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.85 | 0.000 | 0.000 | 0.000 | 0.784 | 0 | 0 | 1247 | 220 |
| 0.80 | 0.000 | 0.000 | 0.000 | 0.784 | 0 | 0 | 1247 | 220 |
| 0.75 | 0.000 | 0.000 | 0.000 | 0.784 | 0 | 0 | 1247 | 220 |
| 0.70 | 0.000 | 0.000 | 0.000 | 0.784 | 0 | 0 | 1247 | 220 |
| 0.65 | 0.000 | 0.000 | 0.000 | 0.784 | 0 | 0 | 1247 | 220 |
| 0.60 | 0.000 | 0.000 | 0.000 | 0.784 | 0 | 0 | 1247 | 220 |
| 0.55 | 0.000 | 0.000 | 0.000 | 0.784 | 0 | 0 | 1247 | 220 |
| 0.50 | 0.667 | 0.009 | 0.018 | 0.784 | 2 | 1 | 1246 | 218 |
| 0.45 | 0.667 | 0.018 | 0.035 | 0.784 | 4 | 2 | 1245 | 216 |
| 0.40 | 0.455 | 0.023 | 0.043 | 0.784 | 5 | 6 | 1241 | 215 |
| 0.35 | 0.455 | 0.023 | 0.043 | 0.784 | 5 | 6 | 1241 | 215 |
| 0.30 | 0.565 | 0.059 | 0.107 | 0.784 | 13 | 10 | 1237 | 207 |

### RF 60% + GB 40%
- Best F1 @ 0.30: F1 **0.148**, Precision 0.528, Recall 0.086
- Max Recall @ 0.30: Recall **0.086**, Precision 0.528

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.85 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.80 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.75 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.70 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.65 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.60 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.55 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.50 | 0.000 | 0.000 | 0.000 | 0.785 | 0 | 0 | 1247 | 220 |
| 0.45 | 0.667 | 0.018 | 0.035 | 0.785 | 4 | 2 | 1245 | 216 |
| 0.40 | 0.500 | 0.023 | 0.043 | 0.785 | 5 | 5 | 1242 | 215 |
| 0.35 | 0.571 | 0.036 | 0.068 | 0.785 | 8 | 6 | 1241 | 212 |
| 0.30 | 0.528 | 0.086 | 0.148 | 0.785 | 19 | 17 | 1230 | 201 |

### RF 40% + GB 60%
- Best F1 @ 0.30: F1 **0.085**, Precision 0.625, Recall 0.045
- Max Recall @ 0.30: Recall **0.045**, Precision 0.625

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.85 | 0.000 | 0.000 | 0.000 | 0.783 | 0 | 0 | 1247 | 220 |
| 0.80 | 0.000 | 0.000 | 0.000 | 0.783 | 0 | 0 | 1247 | 220 |
| 0.75 | 0.000 | 0.000 | 0.000 | 0.783 | 0 | 0 | 1247 | 220 |
| 0.70 | 0.000 | 0.000 | 0.000 | 0.783 | 0 | 0 | 1247 | 220 |
| 0.65 | 0.000 | 0.000 | 0.000 | 0.783 | 0 | 0 | 1247 | 220 |
| 0.60 | 0.000 | 0.000 | 0.000 | 0.783 | 0 | 0 | 1247 | 220 |
| 0.55 | 0.000 | 0.000 | 0.000 | 0.783 | 0 | 1 | 1246 | 220 |
| 0.50 | 0.667 | 0.009 | 0.018 | 0.783 | 2 | 1 | 1246 | 218 |
| 0.45 | 0.667 | 0.018 | 0.035 | 0.783 | 4 | 2 | 1245 | 216 |
| 0.40 | 0.444 | 0.018 | 0.035 | 0.783 | 4 | 5 | 1242 | 216 |
| 0.35 | 0.455 | 0.023 | 0.043 | 0.783 | 5 | 6 | 1241 | 215 |
| 0.30 | 0.625 | 0.045 | 0.085 | 0.783 | 10 | 6 | 1241 | 210 |

### RF & GB agreement (min prob)
- Best F1 @ 0.10: F1 **0.102**, Precision 0.382, Recall 0.059
- Max Recall @ 0.10: Recall **0.059**, Precision 0.382

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.60 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 0 | 1247 | 220 |
| 0.55 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 0 | 1247 | 220 |
| 0.50 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 0 | 1247 | 220 |
| 0.45 | 0.000 | 0.000 | 0.000 | 0.737 | 0 | 0 | 1247 | 220 |
| 0.42 | 1.000 | 0.014 | 0.027 | 0.737 | 3 | 0 | 1247 | 217 |
| 0.40 | 1.000 | 0.014 | 0.027 | 0.737 | 3 | 0 | 1247 | 217 |
| 0.38 | 0.500 | 0.014 | 0.027 | 0.737 | 3 | 3 | 1244 | 217 |
| 0.36 | 0.571 | 0.018 | 0.035 | 0.737 | 4 | 3 | 1244 | 216 |
| 0.34 | 0.500 | 0.018 | 0.035 | 0.737 | 4 | 4 | 1243 | 216 |
| 0.32 | 0.500 | 0.018 | 0.035 | 0.737 | 4 | 4 | 1243 | 216 |
| 0.30 | 0.444 | 0.018 | 0.035 | 0.737 | 4 | 5 | 1242 | 216 |
| 0.25 | 0.500 | 0.032 | 0.060 | 0.737 | 7 | 7 | 1240 | 213 |
| 0.20 | 0.400 | 0.036 | 0.067 | 0.737 | 8 | 12 | 1235 | 212 |
| 0.15 | 0.435 | 0.045 | 0.082 | 0.737 | 10 | 13 | 1234 | 210 |
| 0.10 | 0.382 | 0.059 | 0.102 | 0.737 | 13 | 21 | 1226 | 207 |

### RF × GB geometric mean
- Best F1 @ 0.10: F1 **0.205**, Precision 0.373, Recall 0.141
- Max Recall @ 0.10: Recall **0.141**, Precision 0.373

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.60 | 0.000 | 0.000 | 0.000 | 0.754 | 0 | 0 | 1247 | 220 |
| 0.55 | 0.000 | 0.000 | 0.000 | 0.754 | 0 | 0 | 1247 | 220 |
| 0.50 | 1.000 | 0.005 | 0.009 | 0.754 | 1 | 0 | 1247 | 219 |
| 0.45 | 0.667 | 0.018 | 0.035 | 0.754 | 4 | 2 | 1245 | 216 |
| 0.42 | 0.571 | 0.018 | 0.035 | 0.754 | 4 | 3 | 1244 | 216 |
| 0.40 | 0.444 | 0.018 | 0.035 | 0.754 | 4 | 5 | 1242 | 216 |
| 0.38 | 0.455 | 0.023 | 0.043 | 0.754 | 5 | 6 | 1241 | 215 |
| 0.36 | 0.455 | 0.023 | 0.043 | 0.754 | 5 | 6 | 1241 | 215 |
| 0.34 | 0.455 | 0.023 | 0.043 | 0.754 | 5 | 6 | 1241 | 215 |
| 0.32 | 0.500 | 0.027 | 0.052 | 0.754 | 6 | 6 | 1241 | 214 |
| 0.30 | 0.571 | 0.036 | 0.068 | 0.754 | 8 | 6 | 1241 | 212 |
| 0.25 | 0.478 | 0.050 | 0.091 | 0.754 | 11 | 12 | 1235 | 209 |
| 0.20 | 0.412 | 0.064 | 0.110 | 0.754 | 14 | 20 | 1227 | 206 |
| 0.15 | 0.404 | 0.095 | 0.154 | 0.754 | 21 | 31 | 1216 | 199 |
| 0.10 | 0.373 | 0.141 | 0.205 | 0.754 | 31 | 52 | 1195 | 189 |

### LR 60% + GB 40%
- Best F1 @ 0.35: F1 **0.339**, Precision 0.214, Recall 0.814
- Max Recall @ 0.30: Recall **0.873**, Precision 0.190

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.50 | 0.311 | 0.168 | 0.218 | 0.668 | 37 | 82 | 1165 | 183 |
| 0.45 | 0.237 | 0.400 | 0.297 | 0.668 | 88 | 284 | 963 | 132 |
| 0.40 | 0.219 | 0.605 | 0.322 | 0.668 | 133 | 473 | 774 | 87 |
| 0.35 | 0.214 | 0.814 | 0.339 | 0.668 | 179 | 657 | 590 | 41 |
| 0.30 | 0.190 | 0.873 | 0.313 | 0.668 | 192 | 816 | 431 | 28 |

### LR 60% + RF 40%
- Best F1 @ 0.50: F1 **0.357**, Precision 0.249, Recall 0.627
- Max Recall @ 0.30: Recall **0.923**, Precision 0.185

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.50 | 0.249 | 0.627 | 0.357 | 0.716 | 138 | 416 | 831 | 82 |
| 0.45 | 0.230 | 0.786 | 0.356 | 0.716 | 173 | 580 | 667 | 47 |
| 0.40 | 0.210 | 0.832 | 0.335 | 0.716 | 183 | 689 | 558 | 37 |
| 0.35 | 0.191 | 0.877 | 0.314 | 0.716 | 193 | 817 | 430 | 27 |
| 0.30 | 0.185 | 0.923 | 0.308 | 0.716 | 203 | 896 | 351 | 17 |

### LR 50% + GB 25% + RF 25%
- Best F1 @ 0.45: F1 **0.358**, Precision 0.305, Recall 0.432
- Max Recall @ 0.30: Recall **0.873**, Precision 0.200

| Threshold | Precision | Recall | F1 | ROC AUC | TP | FP | TN | FN |
|-----------|-----------|--------|----|---------|----|----|----|----|
| 0.50 | 0.321 | 0.155 | 0.209 | 0.709 | 34 | 72 | 1175 | 186 |
| 0.45 | 0.305 | 0.432 | 0.358 | 0.709 | 95 | 216 | 1031 | 125 |
| 0.40 | 0.247 | 0.623 | 0.354 | 0.709 | 137 | 417 | 830 | 83 |
| 0.35 | 0.220 | 0.786 | 0.344 | 0.709 | 173 | 612 | 635 | 47 |
| 0.30 | 0.200 | 0.873 | 0.326 | 0.709 | 192 | 766 | 481 | 28 |

## RF + GB Precision Gate (AND Rule)

- **Rule:** Predict injury only when `rf_prob ≥ 0.38` **and** `gb_prob ≥ 0.48`.
- **Out-of-sample metrics:** Precision 0.75, Recall 0.0136, F1 0.0268 (TP 3, FP 1, TN 1246, FN 217).
- Alerts triggered on only four validation days (extremely conservative), matching the target 70–75% precision with significant recall trade-off.